<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Arcane Divination ¬∑ Tarot Reading</title>
  <meta name="theme-color" content="#0f0f13" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&family=Cinzel:wght@400;600;700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #0a0612;
      --panel: #120a1f;
      --muted: #9b8fb8;
      --text: #e8e4f0;
      --brand: #d946ef;
      --brand-2: #f59e0b;
      --accent: #10b981;
      --ring: 0 0 0 2px rgba(217,70,239,.35);
      --shadow: 0 10px 40px rgba(217,70,239,.25);
      --glow: 0 0 30px rgba(217,70,239,.45);
      --glass: rgba(139,92,246,.08);
      --glass-brd: rgba(139,92,246,.25);
      --fool-glow-1: rgba(239,68,68,.25);
      --fool-glow-2: rgba(217,70,239,.35);
    }
    [data-theme="light"]{
      --bg: #faf8fc;
      --panel: #ffffff;
      --muted: #6b5c8a;
      --text: #1e1433;
      --brand: #a855f7;
      --brand-2: #f59e0b;
      --accent: #059669;
      --shadow: 0 8px 30px rgba(168,85,247,.15);
      --glow: 0 0 15px rgba(168,85,247,.2);
      --glass: rgba(168,85,247,.05);
      --glass-brd: rgba(168,85,247,.15);
    }

    *{box-sizing:border-box; margin:0; padding:0}
    html,body{height:100%}
    body{
      font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background:
        radial-gradient(ellipse 1400px 900px at 90% -15%, rgba(217,70,239,.12), transparent 55%),
        radial-gradient(ellipse 1000px 700px at 10% 100%, rgba(245,158,11,.10), transparent 50%),
        var(--bg);
      color:var(--text); line-height:1.6; letter-spacing:.2px;
      background-attachment: fixed; padding:20px;
    }

    .container{max-width:980px; margin:0 auto}
    .header{text-align:center; padding:36px 20px 12px}
    .header h1{
      font-family:'Cinzel', serif; font-size:clamp(30px, 5vw, 48px);
      background:linear-gradient(120deg, var(--brand), var(--brand-2), var(--accent));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      margin-bottom:8px; font-weight:900;
    }
    .header p{color:var(--muted); font-size:15px}

    .controls{display:flex; gap:12px; align-items:center; justify-content:center; flex-wrap:wrap; margin-top:12px}
    .back-btn{
      display:inline-flex; align-items:center; gap:8px; padding:8px 12px;
      background:var(--glass); border:1px solid var(--glass-brd); border-radius:10px;
      color:var(--text); text-decoration:none; transition:all .2s ease; font-weight:500;
    }
    .toggle{
      display:inline-flex; gap:8px; align-items:center; padding:8px 12px;
      background:var(--panel); border-radius:12px; border:1px solid rgba(255,255,255,.04);
      color:var(--text);
    }

    .reading-selector{
      display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
      gap:12px; margin:28px 0;
    }
    .spread-card{
      background:linear-gradient(135deg, rgba(139,92,246,.06), rgba(245,158,11,.05));
      border:1px solid var(--glass-brd); border-radius:16px; padding:18px;
      cursor:pointer; transition:all .25s ease; text-align:center;
    }
    .spread-card:hover{transform:translateY(-4px); border-color:var(--brand); box-shadow:var(--shadow)}
    .spread-card.active{border-color:var(--brand); box-shadow:0 20px 60px rgba(217,70,239,.18)}
    .spread-icon{font-size:40px; margin-bottom:10px}
    .spread-title{font-family:'Cinzel', serif; font-size:18px; font-weight:700; margin-bottom:4px}
    .spread-desc{font-size:13px; color:var(--muted)}

    .btn{
      display:inline-flex; align-items:center; gap:10px; padding:14px 26px;
      background:linear-gradient(135deg, var(--brand), var(--brand-2));
      border:none; border-radius:12px; color:#fff; font-size:15px;
      font-weight:700; cursor:pointer; transition:all .25s ease;
      box-shadow:var(--shadow);
    }
    .btn:hover{transform:translateY(-3px); box-shadow:0 18px 48px rgba(217,70,239,.45)}
    .btn:disabled{opacity:.5; cursor:not-allowed; transform:none}

    .controls-right{display:flex; gap:12px; align-items:center; margin-left:auto}

    .cards-container{
      display:flex; justify-content:center; gap:18px; flex-wrap:wrap;
      margin:34px 0; min-height:360px; align-items:center;
      perspective:1400px;
    }

    .tarot-card{
      width:170px; height:270px; perspective:1000px; cursor:pointer;
      transform-style:preserve-3d; transition:transform .18s ease;
      position:relative;
    }
    .card-inner{
      width:100%; height:100%; position:relative; transition:transform .9s;
      transform-style:preserve-3d;
    }
    .tarot-card.flipped .card-inner{transform:rotateY(180deg)}
    .card-face{
      position:absolute; width:100%; height:100%; backface-visibility:hidden;
      border-radius:14px; display:flex; flex-direction:column; align-items:center;
      justify-content:center; padding:18px; border:2px solid var(--glass-brd);
      box-shadow:var(--shadow); overflow:hidden;
      transition:box-shadow .3s, transform .3s;
    }
    .card-back{
      background:linear-gradient(135deg, rgba(139,92,246,.18), rgba(245,158,11,.12));
      backdrop-filter:blur(6px);
      display:flex; align-items:center; justify-content:center;
      font-size:72px; opacity:.8;
    }
    .card-front{
      background:linear-gradient(135deg, var(--panel), rgba(18,10,31,.95));
      transform:rotateY(180deg); text-align:center; color:var(--text);
      position:relative;
    }

    .card-emoji{font-size:56px; margin-bottom:12px}
    .card-name{
      font-family:'Cinzel', serif; font-size:15px; font-weight:800;
      margin-bottom:8px; color:var(--brand-2);
    }
    .card-meaning{font-size:12px; color:var(--muted); line-height:1.4; min-height:40px}

    .card-front::after{
      content:''; position:absolute; inset:0; pointer-events:none;
      background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02) 50%, rgba(255,255,255,0.03));
      mix-blend-mode:overlay; opacity:0.9;
    }

    .interpretation{
      background:linear-gradient(135deg, rgba(139,92,246,.10), rgba(245,158,11,.08));
      border:1px solid var(--glass-brd); border-radius:14px; padding:22px;
      margin:24px 0; backdrop-filter:blur(6px); box-shadow:var(--shadow);
      opacity:0; transform:translateY(14px); transition:all .5s ease;
    }
    .interpretation.show{opacity:1; transform:translateY(0)}
    .interpretation h2{
      font-family:'Cinzel', serif; font-size:22px; margin-bottom:12px; color:var(--brand-2);
    }
    .card-detail{
      margin:14px 0; padding:14px; background:rgba(0,0,0,.12);
      border-radius:10px; border-left:4px solid var(--brand);
    }
    .card-detail h3{
      font-family:'Cinzel', serif; font-size:16px; color:var(--brand); margin-bottom:8px;
      display:flex; align-items:center; gap:10px;
    }
    .card-detail p{color:var(--text); line-height:1.7; font-size:14px}

    /* Fool visuals */
    .fool-glow {
      box-shadow: 0 0 12px 2px var(--fool-glow-2), 0 0 30px 6px var(--fool-glow-1) inset;
      border-color: rgba(255,255,255,.12);
      animation: foolPulse 2.6s infinite;
    }
    @keyframes foolPulse{
      0%{transform: translateY(0) scale(1)}
      50%{transform: translateY(-4px) scale(1.02)}
      100%{transform: translateY(0) scale(1)}
    }

    .fool-banner{
      text-align:center; font-family:'Cinzel', serif; font-weight:900; margin:16px 0;
      color:transparent; -webkit-background-clip:text; background-clip:text;
      background:linear-gradient(90deg,#ef4444,#d946ef,#f59e0b); font-size:30px;
      animation:shimmer 2.5s linear infinite;
    }
    @keyframes shimmer{0%{filter:hue-rotate(0)}100%{filter:hue-rotate(360deg)}}

    .confetti-piece{
      width:8px;height:12px;border-radius:2px;position:fixed;top:-20px;
      opacity:0.95; transform:translateY(0);
      animation:confettiFall linear forwards;
      z-index:9999;
    }
    @keyframes confettiFall{
      to{transform:translateY(120vh) rotate(720deg); opacity:0.95}
    }

    .reversed .card-inner{transform:rotateZ(180deg)}
    .reversed .card-front{transform:rotateY(180deg) rotate(180deg)}
    .reversed .card-emoji{transform:rotate(180deg)}

    @media (max-width:640px){
      .tarot-card{width:150px;height:240px}
      .spread-icon{font-size:32px}
    }
  </style>
</head>
<body id="pageBody">
  <div class="container">
    <a href="index.html" class="back-btn">‚Üê Return to Grimoire</a>

    <div class="header">
      <h1>üîÆ Arcane Divination</h1>
      <p>Draw from the Major and Minor Arcana. Enable reversals to unlock shadow meanings.</p>
    </div>

    <div class="controls" role="region" aria-label="reading controls">
      <div class="reading-selector" style="flex:1">
        <div class="spread-card active" data-spread="single" role="button" tabindex="0">
          <div class="spread-icon">üÉè</div>
          <div class="spread-title">Single Card</div>
          <div class="spread-desc">Quick insight into your question</div>
        </div>
        <div class="spread-card" data-spread="three" role="button" tabindex="0">
          <div class="spread-icon">üé¥</div>
          <div class="spread-title">Three Card</div>
          <div class="spread-desc">Past ¬∑ Present ¬∑ Future</div>
        </div>
        <div class="spread-card" data-spread="celtic" role="button" tabindex="0">
          <div class="spread-icon">‚ú®</div>
          <div class="spread-title">Celtic Cross</div>
          <div class="spread-desc">Deep, layered reading (simplified)</div>
        </div>
        <div class="spread-card" data-spread="full" role="button" tabindex="0">
          <div class="spread-icon">üîÆ</div>
          <div class="spread-title">Full Reading</div>
          <div class="spread-desc">Majors + Minors + optional reversals</div>
        </div>
      </div>

      <div class="controls-right">
        <label class="toggle" title="Include Minor Arcana">
          <input id="includeMinors" type="checkbox" aria-label="Include Minor Arcana" /> Include Minors
        </label>
        <label class="toggle" title="Allow reversed card meanings">
          <input id="allowReversals" type="checkbox" aria-label="Allow Reversals" /> Allow Reversals
        </label>
        <button class="btn" id="drawBtn">‚ú® Divine Your Fate ‚ú®</button>
      </div>
    </div>

    <div class="cards-container" id="cardsContainer" aria-live="polite"></div>

    <div class="interpretation" id="interpretation" aria-live="polite"></div>
  </div>

  <script>
    // --- Major Arcana (kept concise) ---
    const majorArcana = [
      {slug:'fool', name:'The Fool', emoji:'üÉè', detailed: "Beginnings, leaps of faith, innocence in the face of the unknown. The Fool asks you to step with curiosity rather than fear ‚Äî a threshold between what was and what may be."},
      {slug:'magician', name:'The Magician', emoji:'üé©', detailed: "Manifestation through focused will. You possess the tools to create change; intention and action align to transform ideas into reality."},
      {slug:'high-priestess', name:'The High Priestess', emoji:'üåô', detailed: "Hidden knowledge, intuition, and inner voice. The High Priestess invites silence ‚Äî answers emerge from reflection and dreams rather than outward noise."},
      {slug:'empress', name:'The Empress', emoji:'üëë', detailed: "Fertility, abundance, and creative nurture. A time to cultivate, care, and let projects or relationships ripen into form through tenderness."},
      {slug:'emperor', name:'The Emperor', emoji:'‚öîÔ∏è', detailed: "Structure, boundaries, and leadership. The Emperor recommends discipline and the wise application of power to bring order and safety."},
      {slug:'hierophant', name:'The Hierophant', emoji:'üìø', detailed: "Tradition, mentorship and communal wisdom. Seek counsel or anchor yourself in values that have stood the test of time."},
      {slug:'lovers', name:'The Lovers', emoji:'üíï', detailed: "Relationship, alignment of values, and soulful choices. This card asks you to choose with authenticity and to honor the bonds that reflect your truth."},
      {slug:'chariot', name:'The Chariot', emoji:'üèá', detailed: "Triumph by focused determination. Harness conflicting forces through discipline and confidence; momentum and conquest are possible when you steer clearly."},
      {slug:'strength', name:'Strength', emoji:'ü¶Å', detailed: "Gentle courage, resilience, and compassionate power. True influence comes from patience and quiet resolve rather than force."},
      {slug:'hermit', name:'The Hermit', emoji:'üïØÔ∏è', detailed: "Solitude for inner search. Pull back to illuminate your path; wisdom emerges from focused introspection and honest solitude."},
      {slug:'wheel', name:'Wheel of Fortune', emoji:'üé°', detailed: "Cycles and turning points beyond your control. Accept change as a teacher ‚Äî fortunes shift and new chapters begin."},
      {slug:'justice', name:'Justice', emoji:'‚öñÔ∏è', detailed: "Karma, truth, and balanced accountability. Clear, righteous choices restore balance; consequence and fairness shape outcomes."},
      {slug:'hanged-man', name:'The Hanged Man', emoji:'üôÉ', detailed: "Surrender and perspective-shift. Release attachment to old positions; suspension can reveal unexpected insight and spiritual growth."},
      {slug:'death', name:'Death', emoji:'üíÄ', detailed: "Transformation, endings that birth renewal. Letting go clears the way for authentic reinvention rather than literal destruction."},
      {slug:'temperance', name:'Temperance', emoji:'‚öóÔ∏è', detailed: "Integration and moderation. Synthesis of opposites yields harmony ‚Äî patience and balanced blending heal extremes."},
      {slug:'devil', name:'The Devil', emoji:'üòà', detailed: "Bindings, temptation, and shadow patterns. Name the chains and reclaim agency; liberation begins with honest admission."},
      {slug:'tower', name:'The Tower', emoji:'üè∞', detailed: "Sudden upheaval and revelation. Structures built on illusion crumble; catastrophe opens space for genuine rebuilding."},
      {slug:'star', name:'The Star', emoji:'‚≠ê', detailed: "Hope, healing, and renewed faith. Quiet blessings soothe the spirit and guide toward meaning and restoration."},
      {slug:'moon', name:'The Moon', emoji:'üåï', detailed: "Illusion, dreams, and the deep subconscious. Navigate uncertainties carefully ‚Äî intuition and introspection reveal shadowed truths."},
      {slug:'sun', name:'The Sun', emoji:'‚òÄÔ∏è', detailed: "Joy, clarity, and vitality. Success and warmth shine; this is a time of celebration and life-affirming energy."},
      {slug:'judgement', name:'Judgement', emoji:'üé∫', detailed: "Awakening and reckoning. A call to self-evaluate and answer your deeper vocation; rebirth follows honest appraisal."},
      {slug:'world', name:'The World', emoji:'üåç', detailed: "Completion, synthesis, and travel into new cycles. Celebrate endings as accomplishments; prepare for broader horizons."}
    ];

    // --- Expanded Minor Arcana: 56 bespoke descriptions ---
    const minorArcana = [
      // WANDS (Fire) ‚Äî Action, inspiration
      {slug:'ace-wands', name:'Ace of Wands', suit:'Wands', rank:'Ace', element:'Fire', emoji:'üî•', detailed: "A bright spark of creative impulse or the first push toward a new endeavor. The Ace of Wands heralds potential ‚Äî a call to act with courage and curiosity. If you answer, momentum will follow."},
      {slug:'two-wands', name:'Two of Wands', suit:'Wands', rank:'Two', element:'Fire', emoji:'üî•', detailed: "Vision and early planning: you've seen possibilities and now prepare to choose a path. This card asks you to weigh expansion against risk and to make a decisive survey before you stride."},
      {slug:'three-wands', name:'Three of Wands', suit:'Wands', rank:'Three', element:'Fire', emoji:'üî•', detailed: "Initial efforts bear the shape of future success; your plans extend outward. Expect results from past initiative and consider partnerships or trade that magnify your reach."},
      {slug:'four-wands', name:'Four of Wands', suit:'Wands', rank:'Four', element:'Fire', emoji:'üî•', detailed: "A moment of celebration, community, and restful achievement. The Four of Wands marks a milestone where effort meets joy ‚Äî take time to enjoy the harvest before starting again."},
      {slug:'five-wands', name:'Five of Wands', suit:'Wands', rank:'Five', element:'Fire', emoji:'üî•', detailed: "Conflict, competition, and energetic friction. Rather than ruin, these clashes refine ideas; learn the rules of engagement and pick the battles that teach you strength."},
      {slug:'six-wands', name:'Six of Wands', suit:'Wands', rank:'Six', element:'Fire', emoji:'üî•', detailed: "Public recognition, a victory lap after struggle. The Six of Wands suggests you will be seen for your achievements ‚Äî accept praise and use it responsibly."},
      {slug:'seven-wands', name:'Seven of Wands', suit:'Wands', rank:'Seven', element:'Fire', emoji:'üî•', detailed: "Defend your position with resolve. Others may challenge your territory, but courage and a firm stance will protect what you've built."},
      {slug:'eight-wands', name:'Eight of Wands', suit:'Wands', rank:'Eight', element:'Fire', emoji:'üî•', detailed: "Swift movement and news in motion. Projects accelerate; communications arrive ‚Äî be ready to act quickly and keep momentum steady."},
      {slug:'nine-wands', name:'Nine of Wands', suit:'Wands', rank:'Nine', element:'Fire', emoji:'üî•', detailed: "Perseverance after many trials. You may be weary, yet this card shows you standing guard: resilience now will secure long-awaited gains."},
      {slug:'ten-wands', name:'Ten of Wands', suit:'Wands', rank:'Ten', element:'Fire', emoji:'üî•', detailed: "Burden and overextension: success carries weight. Delegate or shed what exhausts you ‚Äî the goal isn't suffering, it's mastery with sustainable energy."},
      {slug:'page-wands', name:'Page of Wands', suit:'Wands', rank:'Page', element:'Fire', emoji:'üî•', detailed: "A messenger of inspiration ‚Äî youthful zeal, prototypes, and bright curiosity. Follow the Page's playful prompt and test small experiments."},
      {slug:'knight-wands', name:'Knight of Wands', suit:'Wands', rank:'Knight', element:'Fire', emoji:'üî•', detailed: "Bold pursuit and adventurous drive. The Knight charges ahead; temper daring with a plan to avoid reckless pitfalls."},
      {slug:'queen-wands', name:'Queen of Wands', suit:'Wands', rank:'Queen', element:'Fire', emoji:'üî•', detailed: "Charismatic leadership and creative warmth. The Queen channels ambition into generosity, supporting others while pursuing her craft."},
      {slug:'king-wands', name:'King of Wands', suit:'Wands', rank:'King', element:'Fire', emoji:'üî•', detailed: "Commanding vision and entrepreneurial authority. The King masters risk with clarity and inspires teams toward high aims."},

      // CUPS (Water) ‚Äî Emotions, relationships
      {slug:'ace-cups', name:'Ace of Cups', suit:'Cups', rank:'Ace', element:'Water', emoji:'ü•õ', detailed: "A fountain of feeling: new love, healing, or a fresh emotional beginning. Open your heart and allow tenderness to flow without fear of the unknown."},
      {slug:'two-cups', name:'Two of Cups', suit:'Cups', rank:'Two', element:'Water', emoji:'ü•õ', detailed: "Mutual attraction and the promise of partnership. This card celebrates reciprocal feelings, healing reconciliations, or balanced collaborations."},
      {slug:'three-cups', name:'Three of Cups', suit:'Cups', rank:'Three', element:'Water', emoji:'ü•õ', detailed: "Community, celebration, and emotional support. Gather with those who uplift you; collective joy strengthens each member of the circle."},
      {slug:'four-cups', name:'Four of Cups', suit:'Cups', rank:'Four', element:'Water', emoji:'ü•õ', detailed: "A malaise of the heart ‚Äî offers go unnoticed when you're inward. Sit with your discontent; boredom sometimes signals unmet deeper needs."},
      {slug:'five-cups', name:'Five of Cups', suit:'Cups', rank:'Five', element:'Water', emoji:'ü•õ', detailed: "Grief and focusing on loss. Mourning matters; yet notice what remains ‚Äî healing begins by honoring sadness and discovering small consolations."},
      {slug:'six-cups', name:'Six of Cups', suit:'Cups', rank:'Six', element:'Water', emoji:'ü•õ', detailed: "Nostalgia, kindness, and childhood echoes. A gentle reminder to reconnect with simple pleasures and acts of forgiveness."},
      {slug:'seven-cups', name:'Seven of Cups', suit:'Cups', rank:'Seven', element:'Water', emoji:'ü•õ', detailed: "Many desires, fantasized choices. Discern between illusion and substance ‚Äî clarity requires focused longing rather than diffuse wishful thinking."},
      {slug:'eight-cups', name:'Eight of Cups', suit:'Cups', rank:'Eight', element:'Water', emoji:'ü•õ', detailed: "Walking away from what once sustained you. Courageous withdrawal can open the path toward truer fulfillment."},
      {slug:'nine-cups', name:'Nine of Cups', suit:'Cups', rank:'Nine', element:'Water', emoji:'ü•õ', detailed: "Satisfaction and heartfelt enjoyment. Wishes fulfilled may be simple pleasures ‚Äî savor them and share your abundance."},
      {slug:'ten-cups', name:'Ten of Cups', suit:'Cups', rank:'Ten', element:'Water', emoji:'ü•õ', detailed: "Emotional harmony and family blessings. The Ten of Cups is domestic peace realized; cherish the bonds that form your sanctuary."},
      {slug:'page-cups', name:'Page of Cups', suit:'Cups', rank:'Page', element:'Water', emoji:'ü•õ', detailed: "A tender message, dream, or artistic impulse. Listen to the Page: curiosity in feeling can awaken creative gifts."},
      {slug:'knight-cups', name:'Knight of Cups', suit:'Cups', rank:'Knight', element:'Water', emoji:'ü•õ', detailed: "A romantic or idealistic quest. The Knight follows his heart; be mindful of sentimentality and seek balance with grounded action."},
      {slug:'queen-cups', name:'Queen of Cups', suit:'Cups', rank:'Queen', element:'Water', emoji:'ü•õ', detailed: "Emotional mastery and deep compassion. The Queen holds feeling as a source of wisdom and supports others without losing herself."},
      {slug:'king-cups', name:'King of Cups', suit:'Cups', rank:'King', element:'Water', emoji:'ü•õ', detailed: "Mature empathy and steady emotional governance. Lead with calm counsel, stabilizing turbulent waters for those in need."},

      // SWORDS (Air) ‚Äî Thought, conflict
      {slug:'ace-swords', name:'Ace of Swords', suit:'Swords', rank:'Ace', element:'Air', emoji:'‚öîÔ∏è', detailed: "A flash of intellectual clarity or decisive truth. Cut through confusion with honest words and a sharp inner logic."},
      {slug:'two-swords', name:'Two of Swords', suit:'Swords', rank:'Two', element:'Air', emoji:'‚öîÔ∏è', detailed: "Stalemate and difficult choices. You may be avoiding a decision; bring facts into the light and balance head with heart."},
      {slug:'three-swords', name:'Three of Swords', suit:'Swords', rank:'Three', element:'Air', emoji:'‚öîÔ∏è', detailed: "Pain, heartbreak, and piercing truth. Sorrow stings now, but clarity follows honesty ‚Äî let grief teach and refine your limits."},
      {slug:'four-swords', name:'Four of Swords', suit:'Swords', rank:'Four', element:'Air', emoji:'‚öîÔ∏è', detailed: "Rest and recuperation for an overworked mind. Withdraw to heal; the calm prepares you for clearer strategy ahead."},
      {slug:'five-swords', name:'Five of Swords', suit:'Swords', rank:'Five', element:'Air', emoji:'‚öîÔ∏è', detailed: "Pyrrhic victories and ethical cost. Winning at the expense of trust harms future ground ‚Äî consider whether the gain is worth the price."},
      {slug:'six-swords', name:'Six of Swords', suit:'Swords', rank:'Six', element:'Air', emoji:'‚öîÔ∏è', detailed: "Transitioning away from turbulence toward calmer thinking. The Six signals necessary travel‚Äîliteral or mental‚Äîtoward repair."},
      {slug:'seven-swords', name:'Seven of Swords', suit:'Swords', rank:'Seven', element:'Air', emoji:'‚öîÔ∏è', detailed: "Cunning, stealth, or selective honesty. Beware of deceit ‚Äî yours or others' ‚Äî and reclaim integrity where possible."},
      {slug:'eight-swords', name:'Eight of Swords', suit:'Swords', rank:'Eight', element:'Air', emoji:'‚öîÔ∏è', detailed: "Feeling trapped by thought patterns. The prison is mostly mental; small acts of reframing unlock wide freedom."},
      {slug:'nine-swords', name:'Nine of Swords', suit:'Swords', rank:'Nine', element:'Air', emoji:'‚öîÔ∏è', detailed: "Anxiety and sleepless worry dominating the mind. Name the fears; many are shadowed exaggerations that lose power when precisely described."},
      {slug:'ten-swords', name:'Ten of Swords', suit:'Swords', rank:'Ten', element:'Air', emoji:'‚öîÔ∏è', detailed: "A final rupture in thought or situation ‚Äî an ending that hurts but clears the slate for new insight. After the nadir, recovery begins."},
      {slug:'page-swords', name:'Page of Swords', suit:'Swords', rank:'Page', element:'Air', emoji:'‚öîÔ∏è', detailed: "Curiosity and alertness; a student of ideas. The Page brings questions and the need to test assumptions diligently."},
      {slug:'knight-swords', name:'Knight of Swords', suit:'Swords', rank:'Knight', element:'Air', emoji:'‚öîÔ∏è', detailed: "Swift intellect and direct action. The Knight charges ideas forward ‚Äî be mindful to temper speed with care for consequences."},
      {slug:'queen-swords', name:'Queen of Swords', suit:'Swords', rank:'Queen', element:'Air', emoji:'‚öîÔ∏è', detailed: "Hard-earned clarity and fair discernment. The Queen cuts through sentiment to deliver precise counsel and necessary boundaries."},
      {slug:'king-swords', name:'King of Swords', suit:'Swords', rank:'King', element:'Air', emoji:'‚öîÔ∏è', detailed: "Judicious thought, law, and strategy. The King applies reason with ethics ‚Äî a ruler of clear principles and decisive judgment."},

      // PENTACLES (Earth) ‚Äî Material, work, body
      {slug:'ace-pentacles', name:'Ace of Pentacles', suit:'Pentacles', rank:'Ace', element:'Earth', emoji:'üèµÔ∏è', detailed: "A seed of material opportunity: a job, offering, or grounded start. Nurture it practically and it will grow into lasting security."},
      {slug:'two-pentacles', name:'Two of Pentacles', suit:'Pentacles', rank:'Two', element:'Earth', emoji:'üèµÔ∏è', detailed: "Balance and juggling of responsibilities. Skillful management keeps the flow steady ‚Äî remain flexible when currents shift."},
      {slug:'three-pentacles', name:'Three of Pentacles', suit:'Pentacles', rank:'Three', element:'Earth', emoji:'üèµÔ∏è', detailed: "Craftsmanship and collaborative building. Recognition comes from skillful contribution and shared standards of excellence."},
      {slug:'four-pentacles', name:'Four of Pentacles', suit:'Pentacles', rank:'Four', element:'Earth', emoji:'üèµÔ∏è', detailed: "Holding on tightly to resources. Conservatism ensures survival but beware of hoarding that stifles growth."},
      {slug:'five-pentacles', name:'Five of Pentacles', suit:'Pentacles', rank:'Five', element:'Earth', emoji:'üèµÔ∏è', detailed: "Hardship, scarcity, or feeling left out in the cold. Seek aid and community ‚Äî scarcity is eased by reaching for support."},
      {slug:'six-pentacles', name:'Six of Pentacles', suit:'Pentacles', rank:'Six', element:'Earth', emoji:'üèµÔ∏è', detailed: "Generosity and reciprocal giving. Share when you can and accept help when you need it ‚Äî fairness strengthens networks."},
      {slug:'seven-pentacles', name:'Seven of Pentacles', suit:'Pentacles', rank:'Seven', element:'Earth', emoji:'üèµÔ∏è', detailed: "Assessment of invested effort. Pause to measure results and decide whether to continue or reallocate your energies."},
      {slug:'eight-pentacles', name:'Eight of Pentacles', suit:'Pentacles', rank:'Eight', element:'Earth', emoji:'üèµÔ∏è', detailed: "Apprenticeship and diligent practice. Mastery comes through repetition; honor the process rather than rush to prestige."},
      {slug:'nine-pentacles', name:'Nine of Pentacles', suit:'Pentacles', rank:'Nine', element:'Earth', emoji:'üèµÔ∏è', detailed: "Self-sufficiency and refined comfort. The fruits of disciplined labor allow graceful independence and quiet luxury."},
      {slug:'ten-pentacles', name:'Ten of Pentacles', suit:'Pentacles', rank:'Ten', element:'Earth', emoji:'üèµÔ∏è', detailed: "Long-term legacy, family wealth, and stable foundations. Consider how present actions will shape an inheritance of value."},
      {slug:'page-pentacles', name:'Page of Pentacles', suit:'Pentacles', rank:'Page', element:'Earth', emoji:'üèµÔ∏è', detailed: "A studious, grounded offer or beginning. The Page brings an invitation to learn practical skills and steward resources well."},
      {slug:'knight-pentacles', name:'Knight of Pentacles', suit:'Pentacles', rank:'Knight', element:'Earth', emoji:'üèµÔ∏è', detailed: "Steady effort and reliable execution. Slow-moving but dependable ‚Äî the Knight methodically secures results over time."},
      {slug:'queen-pentacles', name:'Queen of Pentacles', suit:'Pentacles', rank:'Queen', element:'Earth', emoji:'üèµÔ∏è', detailed: "Nurturing prosperity and practical warmth. The Queen blends caregiving with sensible management of household and resources."},
      {slug:'king-pentacles', name:'King of Pentacles', suit:'Pentacles', rank:'King', element:'Earth', emoji:'üèµÔ∏è', detailed: "Economic authority and prudent leadership. The King offers stable stewardship and wise investment of tangible assets."}
    ];

    // Utility: shuffle an array copy
    function shuffle(arr){
      const copy = arr.slice();
      for(let i = copy.length -1; i>0; i--){
        const j = Math.floor(Math.random()*(i+1));
        [copy[i], copy[j]] = [copy[j], copy[i]];
      }
      return copy;
    }

    // UI state
    let currentSpread = 'single';
    let foolMode = false;
    let readingCount = 0;

    // spread selector
    document.querySelectorAll('.spread-card').forEach(card => {
      card.addEventListener('click', () => {
        document.querySelectorAll('.spread-card').forEach(c => c.classList.remove('active'));
        card.classList.add('active');
        currentSpread = card.dataset.spread;
        clearOutput();
      });
      card.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.key === ' ') card.click();
      });
    });

    // helper to clear output
    function clearOutput(){
      document.getElementById('cardsContainer').innerHTML = '';
      const interpretation = document.getElementById('interpretation');
      interpretation.innerHTML = '';
      interpretation.classList.remove('show');
      document.getElementById('pageBody').classList.remove('fool-mode-body');
    }

    // draw logic
    document.getElementById('drawBtn').addEventListener('click', () => {
      readingCount++;
      clearOutput();

      // Every 3-5 readings, possible fool blessing
      const shouldActivateFool = readingCount % (3 + Math.floor(Math.random()*3)) === 0;
      foolMode = shouldActivateFool;

      const includeMinors = document.getElementById('includeMinors').checked;
      const allowReversals = document.getElementById('allowReversals').checked;

      // choose how many cards
      let numCards, positions;
      if(currentSpread === 'single'){
        numCards = 1; positions = ['Answer'];
      } else if(currentSpread === 'three'){
        numCards = 3; positions = ['Past','Present','Future'];
      } else if(currentSpread === 'celtic'){
        numCards = 5; positions = ['Present','Challenge','Past','Future','Outcome'];
      } else {
        numCards = 7; positions = ['Anchor','Obstacle','Heart','Mind','Near Future','Advice','Outcome'];
      }

      // Build normal pool (majors + optionally minors)
      let pool = majorArcana.map(m => ({...m, arcana:'major'}));
      if(includeMinors || currentSpread === 'full'){
        pool = pool.concat(minorArcana.map(m => ({...m, arcana:'minor'})));
      }

      let selection = [];

      if(foolMode){
        // When blessed by the Fool: every drawn card is The Fool.
        // Create numCards copies of The Fool with a flag to render glow.
        const foolCard = {...majorArcana.find(m => m.slug === 'fool'), arcana:'major', foolBless:true};
        for(let i=0;i<numCards;i++){
          const c = {...foolCard};
          c.position = positions[i] || `Position ${i+1}`;
          // optionally reversed randomly if allowed (but visually The Fool is same)
          c.reversed = allowReversals ? (Math.random() < 0.3) : false;
          selection.push(c);
        }
      } else {
        // Normal draw: shuffle pool and take top numCards (respecting no duplicates)
        const shuffled = shuffle(pool);
        let i=0,j=0;
        while(i<numCards && j<shuffled.length){
          const cand = {...shuffled[j]};
          cand.reversed = allowReversals ? (Math.random() < 0.45) : false;
          cand.position = positions[i] || `Position ${i+1}`;

          // for minors ensure detailed is set from minorArcana list
          if(cand.arcana === 'minor'){
            // find the matching entry in minorArcana array to get detailed text
            const found = minorArcana.find(m=>m.slug === cand.slug || m.name === cand.name);
            if(found) cand.detailed = found.detailed;
            else cand.detailed = `${cand.rank} of ${cand.suit} ‚Äî ${cand.element} energy.`;
          }

          selection.push(cand);
          i++; j++;
        }
      }

      renderCards(selection, foolMode);
      setTimeout(()=> showInterpretation(selection, foolMode), numCards * 320 + 700);
    });

    // Render selected cards to DOM with flip animation and reversal visual
    function renderCards(selection, isFool){
      const container = document.getElementById('cardsContainer');
      container.innerHTML = '';

      // apply global fool visuals
      if(isFool){
        document.getElementById('pageBody').classList.add('fool-mode-body');
        triggerConfetti(26);
      } else {
        document.getElementById('pageBody').classList.remove('fool-mode-body');
      }

      selection.forEach((card, idx) => {
        const cardEl = document.createElement('div');
        cardEl.className = 'tarot-card';
        if(card.reversed) cardEl.classList.add('reversed');

        const isMajor = card.arcana === 'major';
        const name = card.name || (isMajor ? card.name : card.name);
        const emoji = card.emoji || 'üîÆ';
        const meaningSnippet = (isMajor ? (card.detailed ? card.detailed.split('.')[0] : '') : (card.detailed || ''));

        // Add fool glow class to the front when in foolMode (all cards become The Fool)
        const frontClass = card.foolBless ? 'fool-glow' : '';

        cardEl.innerHTML = `
          <div class="card-inner">
            <div class="card-face card-back" aria-hidden="true">üîÆ</div>
            <div class="card-face card-front ${frontClass}">
              <div class="card-emoji">${emoji}</div>
              <div class="card-name">${name}</div>
              <div class="card-meaning">${meaningSnippet}</div>
            </div>
          </div>
        `;

        // small interactive tilt
        cardEl.addEventListener('mousemove', (e)=>{
          const rect = cardEl.getBoundingClientRect();
          const x = (e.clientX - rect.left) / rect.width - 0.5;
          const y = (e.clientY - rect.top) / rect.height - 0.5;
          cardEl.style.transform = `rotateX(${(-y*6)}deg) rotateY(${(x*8)}deg)`;
        });
        cardEl.addEventListener('mouseleave', ()=>cardEl.style.transform = '');

        // append then flip with stagger
        setTimeout(()=> {
          container.appendChild(cardEl);
          setTimeout(()=> cardEl.classList.add('flipped'), 120);
        }, idx * 260);
      });
    }

    // Show interpretation panel with detailed text and fool-mode narrative
    function showInterpretation(selection, isFool){
      const interpretation = document.getElementById('interpretation');
      interpretation.innerHTML = '';
      interpretation.classList.remove('show');

      if(isFool){
        // Grand, long "Praise The Fool" text ‚Äî this replaces normal reading entirely.
        const header = `<div class="fool-banner">üÉè PRAISE THE FOOL ‚Äî THE GREAT JESTER OF THE THRESHOLD üÉè</div>`;
        const longPraise = `
          <p style="text-align:left; color:var(--muted); margin-bottom:12px; line-height:1.7;">
            All cards are The Fool. The cosmos smiles in riddles; the pattern of meaning melts into a single bright prank.
            This blessing is not petty fortune but a profound overturning. Rules loosen. Certainties become suggestion. The Fool
            offers both ruin and revelation: what seemed fixed is now malleable. Where there was structure there may be laughter;
            where there was fear there may be an inexplicable courage. The Fool asks you to accept paradox, for in that acceptance
            you will find new sight. Do not seek to place this blessing into tidy language ‚Äî it is a portal, a momentary collapse
            of the usual scaffolding so that something stranger and truer can be glimpsed.
          </p>

          <p style="text-align:left; color:var(--muted); margin-bottom:12px; line-height:1.7;">
            Practically: expect improbable coincidence, a reversal of expectations, and an invitation to act from impulse rather than
            calculation. Keep a wry heart. The Fool's laughter loosens knots: if you have been stuck, a ludic twist may offer release.
            If you have been certain, be willing to unlearn. If you cling, prepare for delightfully disruptive change.
          </p>

          <p style="text-align:left; color:var(--muted); margin-bottom:12px; line-height:1.7;">
            Spiritually: this is an initiation into a playful kind of wisdom. The Fool challenges hierarchy and reveals hidden grace
            in folly. Reverence for the Fool is not disorder; it is recognition that the world is stranger than our maps and that
            humility and humor can be gateways to insight. Bow, laugh, and step forward with open hands.
          </p>

          <div class="card-detail">
            <h3>üÉè The Fool's Mandate</h3>
            <p>The Fool invites you to take one deliberate, absurd step: something small but sincere. It may look foolish to others, and
            that is the point. In the wake of that step you may find a new alignment: an answer, a door, or simply a freedom you had
            forgotten. Honor the madness and the mercy together.</p>
          </div>

          <p style="text-align:center; color:var(--muted); font-size:13px; margin-top:8px;">
            This reading is dominated by the archetype of the Fool ‚Äî let the ordinary meanings sleep and attend to the humor, the
            miracle, and the rupture. Praise the Fool.
          </p>
        `;

        interpretation.innerHTML = header + longPraise;
      } else {
        // Normal reading: include each card's expanded description + reversal nuance
        let html = '<h2>‚ú® Your Reading</h2>';
        selection.forEach(card => {
          const title = `${card.emoji || ''} ${card.position}: ${card.name}${card.reversed ? ' (Reversed)' : ''}`;
          const detail = card.arcana === 'major' ? (card.detailed || '') : (card.detailed || '');
          const reversedNote = card.reversed ? '<em style="color:var(--muted); display:block; margin-top:6px;">(Reversed: internal block, delay, or shadow expression ‚Äî reflect on what resists you.)</em>' : '';
          html += `
            <div class="card-detail">
              <h3>${title}</h3>
              <p>${detail}</p>
              ${reversedNote}
            </div>
          `;
        });
        interpretation.innerHTML = html;
      }

      interpretation.classList.add('show');
    }

    // Simple confetti generator (DOM nodes with random colors, fall animation)
    function triggerConfetti(count=12){
      const colors = ['#ef4444','#d946ef','#f59e0b','#10b981','#60a5fa','#fde68a'];
      for(let i=0;i<count;i++){
        const el = document.createElement('div');
        el.className = 'confetti-piece';
        el.style.left = Math.random() * 100 + 'vw';
        el.style.background = colors[Math.floor(Math.random()*colors.length)];
        el.style.transform = `rotate(${Math.random()*360}deg)`;
        const duration = 2500 + Math.random()*2500;
        el.style.animationDuration = duration + 'ms';
        el.style.animationDelay = (Math.random()*300) + 'ms';
        document.body.appendChild(el);
        // clean up
        setTimeout(()=> {
          el.remove();
        }, duration + 800);
      }
    }
  </script>
</body>
</html>
